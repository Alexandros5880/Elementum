(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(e,t,o){}}]),function(e){function t(t){for(var r,l,a=t[0],c=t[1],s=t[2],u=0,p=[];u<a.length;u++)l=a[u],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&p.push(n[l][0]),n[l]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(b&&b(t);p.length;)p.shift()();return i.push.apply(i,s||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],r=!0,a=1;a<o.length;a++){var c=o[a];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=l(l.s=o[0]))}return e}var r={},n={0:0},i=[];function l(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=e,l.c=r,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(o,r,function(t){return e[t]}.bind(null,r));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var b=c;i.push([22,1]),o()}([function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t){!function(){e.exports=this.wp.element}()},function(e,t,o){var r=o(17),n=o(18),i=o(19),l=o(21);e.exports=function(e,t){return r(e)||n(e,t)||i(e,t)||l()}},function(e,t){!function(){e.exports=this.wp.data}()},function(e,t,o){var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)&&r.length){var l=n.apply(null,r);l&&e.push(l)}else if("object"===i)for(var a in r)o.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t){e.exports=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},function(e,t){function o(e,t,o,r,n,i,l){try{var a=e[i](l),c=a.value}catch(e){return void o(e)}a.done?t(c):Promise.resolve(c).then(r,n)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var l=e.apply(t,r);function a(e){o(l,n,i,a,c,"next",e)}function c(e){o(l,n,i,a,c,"throw",e)}a(void 0)}))}}},function(e,t){!function(){e.exports=this.wp.compose}()},function(e,t){!function(){e.exports=this.wp.coreData}()},function(e,t){!function(){e.exports=this.wp.date}()},function(e,t){!function(){e.exports=this.lodash}()},function(e,t){!function(){e.exports=this.wp.keycodes}()},function(e,t,o){},,function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],r=!0,n=!1,i=void 0;try{for(var l,a=e[Symbol.iterator]();!(r=(l=a.next()).done)&&(o.push(l.value),!t||o.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return o}}},function(e,t,o){var r=o(20);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,o){"use strict";o.r(t);var r=o(3),n=o(6),i=o.n(n),l=o(5),a=o(0),c=(o(15),o(16),o(8)),s=o.n(c),b=o(7),u=o.n(b),p=o(9),m=o.n(p),_=o(4),k=o.n(_),v=o(2),w=o(1),f=o(10),h=o(11),d=o(12),g=o(13),y=o(14),E=function(e){var t=function(e){return e&&e.className?e.className:""}(e);return wp.element.createElement(w.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",color:"#eba845"},wp.element.createElement(w.Path,{className:t,fill:"#eba845",stroke:"#eba845",d:"M12,17.3l6.2,3.7l-1.6-7L22,9.2l-7.2-0.6L12,2L9.2,8.6L2,9.2L7.5,14l-1.6,7L12,17.3z"}))},O=function(e){var t,o=e.id,r=e.setRating,n=e.children;return wp.element.createElement("span",{className:"book-review-block__rating-button",tabIndex:0,role:"button",onKeyDown:(t=o,function(e){return e.keyCode===y.ENTER?r(t):null}),onClick:function(e){return function(){return r(e)}}(o)},n)},j=function(e){var t=e.setAttributes,o=e.rating,r=function(e){e===o&&Math.ceil(o)===o&&(e-=.5),t({book_review_rating:e.toString()})};return wp.element.createElement("div",{className:"book-review-block__rating book-review-block__review-rating"},Object(g.range)(1,6).map((function(e){return wp.element.createElement(O,{key:e,id:e,setRating:r},wp.element.createElement("span",null,wp.element.createElement(E,{className:o>=e-.5?null:"is-rating-unfilled"})),wp.element.createElement("span",null,wp.element.createElement(E,{className:o>=e?null:"is-rating-unfilled"})))})))};var x=Object(f.compose)([Object(l.withSelect)((function(e){return{isRequesting:(0,wp.data.select("core/data").isResolving)("core","getEntityRecord",["book-review-block/v1","settings"]),settings:e("core").getEntityRecord("book-review-block/v1","settings")}}))])((function(e){var t=e.attributes,o=e.className,n=e.isRequesting,c=e.isSelected,b=e.setAttributes,p=e.settings,_=t.alt,f=t.backgroundColor,g=t.id,y=t.book_review_author,E=t.book_review_cover_url,O=t.book_review_format,x=t.book_review_genre,N=t.book_review_isbn,S=t.book_review_pages,C=t.book_review_publisher,P=t.book_review_rating,R=t.book_review_release_date,T=t.book_review_series,I=t.book_review_source,A=t.book_review_summary,B=t.book_review_title,D=t.author,F=t.format,L=t.genre,M=t.pages,U=t.publisher,z=t.rating,G=t.releaseDate,J=t.series,K=t.source,q=t.summary,H=t.title,V=t.url,Y=P?parseFloat(P):z,$=E||V,Q=Object(r.useState)(!1),W=k()(Q,2),X=W[0],Z=W[1],ee=Object(r.useState)(!1),te=k()(ee,2),oe=te[0],re=te[1],ne=Object(r.useState)(!1),ie=k()(ne,2),le=ie[0],ae=ie[1],ce=Object(r.useState)(""),se=k()(ce,2),be=se[0],ue=se[1],pe=Object(r.useState)(""),me=k()(pe,2),_e=me[0],ke=me[1],ve=Object(r.useState)(""),we=k()(ve,2),fe=we[0],he=we[1],de=Object(h.useEntityProp)("root","site","date_format"),ge=k()(de,1)[0],ye=wp.element.createElement(r.Fragment,null,wp.element.createElement(w.ExternalLink,{href:"https://console.developers.google.com/flows/enableapi?apiid=books.googleapis.com&keyType=CLIENT_SIDE&reusekey=true"},Object(a.__)("Get an API key.","book-review-block")),Object(a.__)("Note that changing the API key affects all Book Review blocks.","book-review-block"));Object(r.useEffect)((function(){n||p&&p.book_review_api_key&&he(p.book_review_api_key)}),[n]);var Ee=function(){var e=m()(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://www.googleapis.com/books/v1/volumes?q=isbn:".concat(N,"&key=").concat(encodeURIComponent(fe)),Z(!0),ae(!1),ue(""),e.next=6,fetch(t).then((function(e){return e.json()})).then((function(e){if(e)if(e.items&&e.items.length>0&&e.items[0].volumeInfo){var t=e.items[0].volumeInfo;Oe(),t.title&&xe("book_review_title")(t.title),t.authors&&t.authors.length>0&&xe("book_review_author")(t.authors.join()),t.categories&&t.categories.length>0&&xe("book_review_genre")(t.categories.join()),t.publisher&&xe("book_review_publisher")(t.publisher),t.publishedDate&&xe("book_review_release_date")(Object(d.dateI18n)(ge,t.publishedDate)),t.pageCount&&xe("book_review_pages")(t.pageCount.toString()),t.imageLinks&&t.imageLinks.thumbnail&&xe("book_review_cover_url")(t.imageLinks.thumbnail),t.description&&xe("book_review_summary")("<p>"+t.description+"</p>")}else e.error&&e.error.message?ue(e.error.message):e.items||ae(!0)})).catch((function(e){ue(e)})).finally((function(){Z(!1)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){xe("book_review_cover_url")(""),xe("book_review_title")(""),xe("book_review_series")(""),xe("book_review_author")(""),xe("book_review_genre")(""),xe("book_review_publisher")(""),xe("book_review_release_date")(""),xe("book_review_format")(""),xe("book_review_pages")(""),xe("book_review_source")(""),xe("book_review_summary")("")},je=function(e){var t=e.alt,o=e.id,r=e.url;return b({alt:t,id:o,book_review_cover_url:r})},xe=function(e){return function(t){return b(s()({},e,t))}};return wp.element.createElement("div",{className:i()("book-review-block",o,{"has-background":f}),style:{backgroundColor:f}},c&&wp.element.createElement(v.BlockControls,{key:"controls"},wp.element.createElement(w.Toolbar,null,wp.element.createElement(v.MediaUpload,{onSelect:je,allowedTypes:["image"],value:g,render:function(e){var t=e.open;return wp.element.createElement(w.Button,{label:Object(a.__)("Edit Book Cover","book-review-block"),icon:"edit",onClick:t})}}))),c&&wp.element.createElement(v.InspectorControls,{key:"inspector"},wp.element.createElement(v.PanelColorSettings,{initialOpen:!1,title:Object(a.__)("Color Settings","book-review-block"),colorSettings:[{value:f&&f.value,onChange:xe("backgroundColor"),label:Object(a.__)("Background Color","book-review-block")}]}),wp.element.createElement(w.PanelBody,{title:Object(a.__)("ISBN","book-review-block"),initialOpen:!1},le&&wp.element.createElement(w.Notice,{className:"book-review-block__sidebar-notice",status:"error",isDismissible:!1},Object(a.__)("A book with that ISBN was not found.","book-review-block")),be&&wp.element.createElement(w.Notice,{className:"book-review-block__sidebar-notice",status:"error",isDismissible:!1},Object(a.__)(be,"book-review-block")),wp.element.createElement(w.TextControl,{help:Object(a.__)("Enter the ISBN to automatically fill in the book details. You will need to have an API key first.","book-review-block"),placeholder:Object(a.__)("ISBN","book-review-block"),value:N||"",onChange:xe("book_review_isbn")}),wp.element.createElement("div",null,wp.element.createElement(w.Button,{isSecondary:!0,disabled:!N,onClick:Ee},Object(a.__)("Get Book Details","book-review-block")),X&&wp.element.createElement(w.Spinner,null))),wp.element.createElement(w.PanelBody,{title:Object(a.__)("API Key","book-review-block"),initialOpen:!1},_e&&wp.element.createElement(w.Notice,{className:"book-review-block__sidebar-notice",status:"error",isDismissible:!1},Object(a.__)(_e,"book-review-block")),wp.element.createElement(w.TextControl,{help:ye,placeholder:Object(a.__)("API Key","book-review-block"),value:fe,onChange:function(e){return he(e)}}),wp.element.createElement("div",null,wp.element.createElement(w.Button,{isSecondary:!0,disabled:!fe,onClick:function(){var e=Object(l.dispatch)("core").saveEntityRecord;re(!0),e("book-review-block/v1","settings",{book_review_api_key:fe}).catch((function(e){ke(e)})).finally((function(){re(!1)}))}},Object(a.__)("Save API Key","book-review-block")),oe&&wp.element.createElement(w.Spinner,null)))),!$&&wp.element.createElement(v.MediaPlaceholder,{accept:"image/*",allowedTypes:["image"],icon:"format-image",instructions:Object(a.__)("Upload or insert book cover from media library","book-review-block"),labels:{title:Object(a.__)("Book Cover","book-review-block"),name:Object(a.__)("an image","book-review-block")},onSelect:je}),!!$&&wp.element.createElement("div",{className:"book-review-block__cover-wrapper"},wp.element.createElement("img",{alt:_,className:"book-review-block__cover",src:$})),wp.element.createElement("div",{className:"book-review-block__details"},wp.element.createElement(v.RichText,{onChange:xe("book_review_title"),placeholder:Object(a.__)("Title","book-review-block"),value:B||H,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_series"),placeholder:Object(a.__)("Series","book-review-block"),value:T||J,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_author"),placeholder:Object(a.__)("Author","book-review-block"),value:y||D,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_genre"),placeholder:Object(a.__)("Genre","book-review-block"),value:x||L,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_publisher"),placeholder:Object(a.__)("Publisher","book-review-block"),value:C||U,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_release_date"),placeholder:Object(a.__)("Release Date","book-review-block"),value:R||G,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_format"),placeholder:Object(a.__)("Format","book-review-block"),value:O||F,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_pages"),placeholder:Object(a.__)("Pages","book-review-block"),value:S||M,keepPlaceholderOnFocus:!0}),wp.element.createElement(v.RichText,{onChange:xe("book_review_source"),placeholder:Object(a.__)("Source","book-review-block"),value:I||K,keepPlaceholderOnFocus:!0}),wp.element.createElement(j,{rating:Y,setAttributes:b}),wp.element.createElement(v.RichText,{multiline:"p",onChange:xe("book_review_summary"),placeholder:Object(a.__)("Description","book-review-block"),value:A||q,className:"book-review-block__description",inlineToolbar:!0,keepPlaceholderOnFocus:!0})))})),N=wp.blocks.registerBlockType,S=[{rating:5},{rating:4},{rating:3},{rating:2},{rating:1}];Object(l.dispatch)("core").addEntities([{baseURL:"/book-review-block/v1/settings",kind:"book-review-block/v1",name:"settings"}]),N("book-review-block/book-review",{title:Object(a.__)("Book Review","book-review-block"),description:Object(a.__)("Add details such as title, author, cover image, star rating and more to all of your book reviews.","book-review-block"),icon:function(e){return wp.element.createElement(w.Icon,{className:e,icon:wp.element.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement("path",{d:"M2.3,17.3h9.3c0.1,0,0.3,0,0.4,0.1l5.9,4.2c0.3,0.2,0.7,0,0.7-0.3v-3.7c0-0.2,0.2-0.4,0.4-0.4H22 c1.1,0,2-0.9,2-2V2.5c0-1.2-0.7-2.2-2-2.2H2.3C0.7,0.2,0,0.9,0,2.5v12.3C0,16.3,0.7,17.3,2.3,17.3z"}),wp.element.createElement("polygon",{fill:"#ffffff",points:"8.8,12.1 6.5,10.9 4.1,12.1 4.5,9.5 2.6,7.6 5.3,7.2 6.5,4.8 7.6,7.2 10.3,7.6 8.4,9.5"}),wp.element.createElement("path",{fill:"#ffffff",d:"M20.7,7.9h-7c-0.5,0-0.9-0.4-0.9-0.9S13.2,6,13.7,6h7c0.5,0,0.9,0.4,0.9,0.9S21.2,7.9,20.7,7.9z"}),wp.element.createElement("path",{fill:"#ffffff",d:"M20.7,11.5h-7c-0.5,0-0.9-0.4-0.9-0.9s0.4-0.9,0.9-0.9h7c0.5,0,0.9,0.4,0.9,0.9S21.2,11.5,20.7,11.5z"}))})},category:"widgets",supports:{anchor:!0,multiple:!1},attributes:{alt:{type:"string",source:"attribute",selector:"img",attribute:"alt"},backgroundColor:{type:"string"},id:{type:"number"},book_review_author:{type:"string",source:"meta",meta:"book_review_author"},book_review_cover_url:{type:"string",source:"meta",meta:"book_review_cover_url"},book_review_format:{type:"string",source:"meta",meta:"book_review_format"},book_review_genre:{type:"string",source:"meta",meta:"book_review_genre"},book_review_isbn:{type:"string",source:"meta",meta:"book_review_isbn"},book_review_pages:{type:"string",source:"meta",meta:"book_review_pages"},book_review_publisher:{type:"string",source:"meta",meta:"book_review_publisher"},book_review_rating:{type:"string",source:"meta",meta:"book_review_rating"},book_review_release_date:{type:"string",source:"meta",meta:"book_review_release_date"},book_review_series:{type:"string",source:"meta",meta:"book_review_series"},book_review_source:{type:"string",source:"meta",meta:"book_review_source"},book_review_summary:{type:"string",source:"meta",meta:"book_review_summary"},book_review_title:{type:"string",source:"meta",meta:"book_review_title"}},edit:x,save:function(){return null},deprecated:[{attributes:{alt:{type:"string",source:"attribute",selector:"img",attribute:"alt"},author:{type:"array",source:"children",selector:".book-review-block__author"},backgroundColor:{type:"string"},format:{type:"array",source:"children",selector:".book-review-block__format"},genre:{type:"array",source:"children",selector:".book-review-block__genre"},pages:{type:"array",source:"children",selector:".book-review-block__pages"},publisher:{type:"array",source:"children",selector:".book-review-block__publisher"},rating:{type:"string"},releaseDate:{type:"array",source:"children",selector:".book-review-block__release-date"},series:{type:"array",source:"children",selector:".book-review-block__series"},source:{type:"array",source:"children",selector:".book-review-block__source"},summary:{type:"array",source:"children",selector:".book-review-block__description"},title:{type:"array",source:"children",selector:".book-review-block__title"},url:{type:"string",source:"attribute",selector:"img",attribute:"src"}},save:function(e){var t=e.attributes,o=t.alt,r=t.author,n=void 0===r?[]:r,l=t.backgroundColor,a=t.format,c=void 0===a?[]:a,s=t.genre,b=void 0===s?[]:s,u=t.pages,p=void 0===u?[]:u,m=t.publisher,_=void 0===m?[]:m,k=t.rating,v=t.releaseDate,w=void 0===v?[]:v,f=t.series,h=void 0===f?[]:f,d=t.source,g=void 0===d?[]:d,y=t.summary,E=void 0===y?[]:y,O=t.title,j=void 0===O?[]:O,x=t.url,N=i()("book-review-block",{"has-background":l}),C={backgroundColor:l};return wp.element.createElement("div",{className:N,style:C},!!x&&wp.element.createElement("div",{className:"book-review-block__cover-wrapper"},wp.element.createElement("img",{className:"book-review-block__cover",src:x,alt:o})),wp.element.createElement("div",{className:"book-review-block__details"},j.length>0&&wp.element.createElement("span",{className:"book-review-block__title"},j),h.length>0&&wp.element.createElement("span",{className:"book-review-block__series"},h),n.length>0&&wp.element.createElement("span",{className:"book-review-block__author"},n),b.length>0&&wp.element.createElement("span",{className:"book-review-block__genre"},b),_.length>0&&wp.element.createElement("span",{className:"book-review-block__publisher"},_),w.length>0&&wp.element.createElement("span",{className:"book-review-block__release-date"},w),c.length>0&&wp.element.createElement("span",{className:"book-review-block__format"},c),p.length>0&&wp.element.createElement("span",{className:"book-review-block__pages"},p),g.length>0&&wp.element.createElement("span",{className:"book-review-block__source"},g),wp.element.createElement("div",{className:"book-review-block__rating"},S.map((function(e){var t=e.rating;return wp.element.createElement("span",{className:k&&t<=k?"on":"off","data-rating":t,key:t},"☆")}))),E.length>0&&wp.element.createElement("div",{className:"book-review-block__description"},E)))}}]})}]);